-- AI templates store rule-based responses for internal assistant
create table if not exists ai_templates (
    id uuid primary key default uuid_generate_v4(),
    category text not null,
    tag text not null,
    title text,
    body text not null,
    metadata jsonb not null default '{}'::jsonb,
    created_at timestamptz not null default now(),
    updated_at timestamptz not null default now()
);

create index if not exists idx_ai_templates_category_tag
    on ai_templates (category, tag);

-- Seed core greetings (motivational, encouraging, recovery)
insert into ai_templates (category, tag, title, body, metadata) values
('greeting', 'celebration', '–ì–æ—Ä—è—á–∏–π —Å—Ç–∞—Ä—Ç', 'üî• –í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ –¥–µ—Ä–∂–∏—à—å —Ç–µ–º–ø! –°–µ–≥–æ–¥–Ω—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á—É—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Ö–Ω–∏–∫–∏ ‚Äî —Ç–µ–ª–æ –≥–æ—Ç–æ–≤–æ.', '{"tone":"positive","rpe_hint":"–¥–µ—Ä–∂–∏ RPE 7-8","cta":"–∑–∞–≥–ª—è–Ω–∏ –≤ –ø–ª–∞–Ω –∏ –æ—Ç–º–µ—á–∞–π –∫–∞–∂–¥—É—é –ø–æ–±–µ–¥—É"}'),
('greeting', 'celebration', '–ù–∞ –≤–æ–ª–Ω–µ', 'üöÄ –í–∏–¥–Ω–æ, —á—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∑–∞—Ö–æ–¥—è—Ç. –í–æ–∑—å–º–∏ –≤—Ä–µ–º—è –Ω–∞ –∫–æ—Ä–æ—Ç–∫—É—é —Ä–∞–∑–º–∏–Ω–∫—É –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –±–ª–æ–∫—É ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç—É—Ç!', '{"tone":"positive","cta":"–∑–∞–ø—É—Å—Ç–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏ –¥–µ—Ä–∂–∏ —Ä–∏—Ç–º"}'),
('greeting', 'recovery', '–ü–∞—É–∑–∞ ‚Äî —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞', 'üòå –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞. –°–µ–≥–æ–¥–Ω—è —Å—Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –º–æ–±–∏–ª–∏–∑–∞—Ü–∏–∏ –∏ –¥—ã—Ö–∞–Ω–∏–∏, —á—Ç–æ–±—ã –∑–∞–≤—Ç—Ä–∞ –ª–µ—Ç–µ—Ç—å –¥–∞–ª—å—à–µ.', '{"tone":"calm","cta":"–æ—Ç–∫—Ä–æ–π –ø–ª–∞–Ω –∏ –≤—ã–±–µ—Ä–∏ –º—è–≥–∫—É—é —Å–µ—Å—Å–∏—é"}'),
('greeting', 'recovery', '–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞', 'üßò –¢–µ–ª–æ –¥–∞–ª–æ —Å–∏–≥–Ω–∞–ª –ø—Ä–∏—Ç–æ—Ä–º–æ–∑–∏—Ç—å ‚Äî –¥–∞—ë–º –µ–º—É —Ä–µ—Å—É—Ä—Å. –õ—ë–≥–∫–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞ + —Å–æ–Ω = –Ω–æ–≤–∞—è —Å–∏–ª–∞.', '{"tone":"calm","cta":"–ø–æ—Å–º–æ—Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª ¬´–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ¬ª –≤ –ø–ª–∞–Ω–µ—Ä–µ"}'),
('greeting', 'motivation', '–ù–µ —Å–¥–∞—ë–º—Å—è', '‚ö°Ô∏è –ë—ã–≤–∞–µ—Ç, —á—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–µ –∑–∞—à–ª–∞. –≠—Ç–æ –Ω–µ –æ—Ç–∫–∞—Ç, –∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞. –°–µ–≥–æ–¥–Ω—è —Ü–µ–ª—å ‚Äî –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π —Ä–∏—Ç–º –∏ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–π —à–∞–≥.', '{"tone":"motivation","cta":"–≤—ã–±–µ—Ä–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–µ—Å—Å–∏—é –∏ –æ—Ç–º–µ—Ç—å –∏—Ç–æ–≥"}'),
('greeting', 'motivation', '–í—Ç–æ—Ä–æ–µ –¥—ã—Ö–∞–Ω–∏–µ', 'üí™ –î–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª, —Ç—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –≤ –¥–≤–∏–∂–µ–Ω–∏–∏. –°–æ—Å—Ç–∞–≤–ª—é –º—è–≥–∫–∏–π –ø–ª–∞–Ω, —á—Ç–æ–±—ã –≤—Ç—è–Ω—É—Ç—å—Å—è –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∞.', '{"tone":"motivation","cta":"–∑–∞–ø—Ä–æ—Å–∏ –æ–±–ª–µ–≥—á—ë–Ω–Ω—É—é —Å–µ—Å—Å–∏—é, —è –ø–æ–¥—Å–∫–∞–∂—É"}');

-- Seed motivation templates
insert into ai_templates (category, tag, title, body, metadata) values
('motivation', 'streak', '–°–µ—Ä–∏—è —Ä–∞—Å—Ç—ë—Ç', 'üî• –°–µ—Ä–∏—è —É–∂–µ {{current_streak}} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ–¥—Ä—è–¥ ‚Äî —ç—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç! –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π –æ—â—É—â–µ–Ω–∏—è –≤ –∑–∞–º–µ—Ç–∫–∞—Ö, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –¥–µ—Ä–∂–∞—Ç—å —Ç–µ–º–ø.', '{"threshold":3,"cta":"–æ—Ç–º–µ—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"}'),
('motivation', 'comeback', '–í–æ–∑–≤—Ä–∞—Ç –≤ —Ä–∏—Ç–º', 'üîÅ –ö–∞–∂–¥—ã–π –≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ –ø–∞—É–∑—ã ‚Äî –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –ø—Ä–∏–≤—ã—á–∫—É. –ù–∞—á–Ω—ë–º —Å –±–∞–∑–æ–≤–æ–π —Å–µ—Å—Å–∏–∏, —Å–æ—Ö—Ä–∞–Ω—è—è RPE –≤ –∑–æ–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–∞.', '{"cta":"–æ—Ç–∫—Ä–æ–π –±–ª–∏–∂–∞–π—à—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏ –ø–æ—Å—Ç–∞–≤—å —Ñ–æ–∫—É—Å –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É"}'),
('motivation', 'adherence_low', '–í—ã–¥–æ—Ö–Ω–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π', 'üå± –ù–∏–∑–∫–∞—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å ‚Äî –ª–∏—à—å —Å–Ω–∏–º–æ–∫ –º–æ–º–µ–Ω—Ç–∞. –°—Ñ–æ—Ä–º–∏—Ä—É–µ–º –º–∏–∫—Ä–æ-—Ü–µ–ª—å –Ω–∞ –Ω–µ–¥–µ–ª—é: —Ç—Ä–∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ 25 –º–∏–Ω—É—Ç.', '{"cta":"–ø–æ—Å—Ç–∞–≤—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏"}');

-- Seed plan hints
insert into ai_templates (category, tag, title, body, metadata) values
('plan_hint', 'upcoming_session', '–°–ª–µ–¥—É—é—â–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞', 'üìÖ –°–ª–µ–¥—É—é—â–∞—è —Å–µ—Å—Å–∏—è {{weekday}}, {{date_label}}. –§–æ–∫—É—Å: {{focus}}. –ü–æ–¥–¥–µ—Ä–∂–∏ RPE –Ω–∞ —É—Ä–æ–≤–Ω–µ {{target_rpe}} –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å.', '{"include_schedule":true}'),
('plan_hint', 'rest_day', '–î–µ–Ω—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è', 'üí§ –°–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è. –î–æ–±–∞–≤—å 10 –º–∏–Ω—É—Ç –º–æ–±–∏–ª–∏–∑–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ —É—Å–∫–æ—Ä–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ.', '{"include_recovery":true}');

-- Seed technique feedback
insert into ai_templates (category, tag, title, body, metadata) values
('feedback', 'completed_high', '–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç', '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ {{completion_rate}}% –ø–ª–∞–Ω–∞ —Å RPE {{rpe}}. –û—Ç–ª–∏—á–Ω—ã–π —Å–∏–≥–Ω–∞–ª, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–∏–∫—Ä–æ—Ü–∏–∫–ª.', '{"strategy":"progression"}'),
('feedback', 'completed_medium', '–î–µ—Ä–∂–∏–º –±–∞–ª–∞–Ω—Å', 'üëç –ü–ª–∞–Ω –∑–∞–∫—Ä—ã—Ç –Ω–∞ {{completion_rate}}% —Å RPE {{rpe}}. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ –∏ –æ—Ç–º–µ—á–∞–µ–º, –∫–∞–∫–∏–µ –±–ª–æ–∫–∏ –∑–∞—à–ª–∏ –ª—É—á—à–µ –≤—Å–µ–≥–æ.', '{"strategy":"maintain"}'),
('feedback', 'missed', '–ë—ã–≤–∞–µ—Ç', '‚ôªÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–µ –∑–∞—à–ª–∞. –í–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å –ø—Ä–∏—á–∏–Ω—É: –≤—Ä–µ–º—è, –Ω–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π. –°–¥–µ–ª–∞–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫—É –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ —Å–µ—Å—Å–∏–∏.', '{"strategy":"adjust"}');
